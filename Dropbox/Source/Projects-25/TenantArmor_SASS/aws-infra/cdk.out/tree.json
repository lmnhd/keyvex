{"version":"tree-0.1","tree":{"id":"App","path":"","children":{"TenantArmorStack":{"id":"TenantArmorStack","path":"TenantArmorStack","children":{"LeaseUploadsBucket":{"id":"LeaseUploadsBucket","path":"TenantArmorStack/LeaseUploadsBucket","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/LeaseUploadsBucket/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketName":"tenantarmorstack-lease-uploads","corsConfiguration":{"corsRules":[{"allowedHeaders":["*"],"allowedMethods":["PUT","GET","POST","HEAD"],"allowedOrigins":["http://localhost:3000","https://*.vercel.app","https://tenantarmor.com"],"exposedHeaders":["ETag"]}]},"lifecycleConfiguration":{"rules":[{"abortIncompleteMultipartUpload":{"daysAfterInitiation":1},"status":"Enabled"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.197.0"}},"Policy":{"id":"Policy","path":"TenantArmorStack/LeaseUploadsBucket/Policy","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/LeaseUploadsBucket/Policy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"LeaseUploadsBucketDC35BC91"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["LeaseUploadsBucketDC35BC91","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["LeaseUploadsBucketDC35BC91","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.197.0","metadata":[]}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"TenantArmorStack/LeaseUploadsBucket/AutoDeleteObjectsCustomResource","children":{"Default":{"id":"Default","path":"TenantArmorStack/LeaseUploadsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.197.0","metadata":[]}},"Notifications":{"id":"Notifications","path":"TenantArmorStack/LeaseUploadsBucket/Notifications","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/LeaseUploadsBucket/Notifications/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}}},"constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"AllowBucketNotificationsToTenantArmorStackProcessUploadedLeaseLambda3BBEFBC8":{"id":"AllowBucketNotificationsToTenantArmorStackProcessUploadedLeaseLambda3BBEFBC8","path":"TenantArmorStack/LeaseUploadsBucket/AllowBucketNotificationsToTenantArmorStackProcessUploadedLeaseLambda3BBEFBC8","attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["ProcessUploadedLeaseLambda6238D151","Arn"]},"principal":"s3.amazonaws.com","sourceAccount":{"Ref":"AWS::AccountId"},"sourceArn":{"Fn::GetAtt":["LeaseUploadsBucketDC35BC91","Arn"]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.197.0","metadata":[]}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"TenantArmorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","children":{"Staging":{"id":"Staging","path":"TenantArmorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.197.0"}},"Role":{"id":"Role","path":"TenantArmorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}},"Handler":{"id":"Handler","path":"TenantArmorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.197.0"}},"LeaseAnalysesTable":{"id":"LeaseAnalysesTable","path":"TenantArmorStack/LeaseAnalysesTable","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/LeaseAnalysesTable/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"analysisId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"analysisId","keyType":"HASH"}],"streamSpecification":{"streamViewType":"NEW_AND_OLD_IMAGES"},"tableName":"TenantArmorStack-LeaseAnalyses"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.197.0"}},"ScalingRole":{"id":"ScalingRole","path":"TenantArmorStack/LeaseAnalysesTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.197.0","metadata":[]}},"EvictionTemplatesTable":{"id":"EvictionTemplatesTable","path":"TenantArmorStack/EvictionTemplatesTable","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/EvictionTemplatesTable/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"state","attributeType":"S"},{"attributeName":"templateName","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"state","keyType":"HASH"},{"attributeName":"templateName","keyType":"RANGE"}],"tableName":"EvictionResponseTemplates"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.197.0"}},"ScalingRole":{"id":"ScalingRole","path":"TenantArmorStack/EvictionTemplatesTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.197.0","metadata":[]}},"AIPromptsTable":{"id":"AIPromptsTable","path":"TenantArmorStack/AIPromptsTable","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/AIPromptsTable/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"promptType","attributeType":"S"},{"attributeName":"version","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"promptType","keyType":"HASH"},{"attributeName":"version","keyType":"RANGE"}],"tableName":"TenantArmorStack-AIPrompts"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.197.0"}},"ScalingRole":{"id":"ScalingRole","path":"TenantArmorStack/AIPromptsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.197.0","metadata":[]}},"AIPromptsBucket":{"id":"AIPromptsBucket","path":"TenantArmorStack/AIPromptsBucket","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/AIPromptsBucket/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketName":{"Fn::Join":["",["tenantarmorstack-ai-prompts-",{"Ref":"AWS::AccountId"}]]},"corsConfiguration":{"corsRules":[{"allowedHeaders":["*"],"allowedMethods":["GET","PUT"],"allowedOrigins":["*"]}]},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.197.0"}},"Policy":{"id":"Policy","path":"TenantArmorStack/AIPromptsBucket/Policy","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/AIPromptsBucket/Policy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AIPromptsBucket0DF82D69"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["AIPromptsBucket0DF82D69","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AIPromptsBucket0DF82D69","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.197.0","metadata":[]}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"TenantArmorStack/AIPromptsBucket/AutoDeleteObjectsCustomResource","children":{"Default":{"id":"Default","path":"TenantArmorStack/AIPromptsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.197.0","metadata":[]}},"PyMuPdfKlayer":{"id":"PyMuPdfKlayer","path":"TenantArmorStack/PyMuPdfKlayer","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"PdfProcessorLambdaRole":{"id":"PdfProcessorLambdaRole","path":"TenantArmorStack/PdfProcessorLambdaRole","children":{"ImportPdfProcessorLambdaRole":{"id":"ImportPdfProcessorLambdaRole","path":"TenantArmorStack/PdfProcessorLambdaRole/ImportPdfProcessorLambdaRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"Resource":{"id":"Resource","path":"TenantArmorStack/PdfProcessorLambdaRole/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.197.0"}},"DefaultPolicy":{"id":"DefaultPolicy","path":"TenantArmorStack/PdfProcessorLambdaRole/DefaultPolicy","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/PdfProcessorLambdaRole/DefaultPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["LeaseUploadsBucketDC35BC91","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["LeaseUploadsBucketDC35BC91","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["LeaseAnalysesTableB22F85EA","Arn"]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"PdfProcessorLambdaRoleDefaultPolicyBBF4899A","roles":[{"Ref":"PdfProcessorLambdaRoleD51BBF8B"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.197.0","metadata":[]}},"ProcessUploadedLeaseLambda":{"id":"ProcessUploadedLeaseLambda","path":"TenantArmorStack/ProcessUploadedLeaseLambda","children":{"Code":{"id":"Code","path":"TenantArmorStack/ProcessUploadedLeaseLambda/Code","children":{"Stage":{"id":"Stage","path":"TenantArmorStack/ProcessUploadedLeaseLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.197.0"}},"AssetBucket":{"id":"AssetBucket","path":"TenantArmorStack/ProcessUploadedLeaseLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.197.0"}},"Resource":{"id":"Resource","path":"TenantArmorStack/ProcessUploadedLeaseLambda/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"9a335fd3da6bd091c8a93bf62a07537bf58842ff733038cef6c35b4b249ae682.zip"},"environment":{"variables":{"LEASE_ANALYSES_TABLE_NAME":{"Ref":"LeaseAnalysesTableB22F85EA"},"NEXTJS_API_ENDPOINT_FOR_LAMBDA":"https://tenant-armor.vercel.app/api/ai/initiate-lease-analysis"}},"functionName":"TenantArmorStack-ProcessUploadedLease","handler":"index.handler","layers":["arn:aws:lambda:us-east-1:770693421928:layer:Klayers-p312-PyMuPDF:6"],"memorySize":1024,"role":{"Fn::GetAtt":["PdfProcessorLambdaRoleD51BBF8B","Arn"]},"runtime":"python3.12","timeout":180}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.197.0","metadata":[]}},"BucketNotificationsHandler050a0587b7544547bf325f094a3db834":{"id":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834","path":"TenantArmorStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834","children":{"Role":{"id":"Role","path":"TenantArmorStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role","children":{"ImportRole":{"id":"ImportRole","path":"TenantArmorStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"Resource":{"id":"Resource","path":"TenantArmorStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.197.0"}},"DefaultPolicy":{"id":"DefaultPolicy","path":"TenantArmorStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:PutBucketNotification","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36","roles":[{"Ref":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.197.0","metadata":[]}},"Resource":{"id":"Resource","path":"TenantArmorStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}}},"constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"AILeaseProcessingDLQ":{"id":"AILeaseProcessingDLQ","path":"TenantArmorStack/AILeaseProcessingDLQ","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/AILeaseProcessingDLQ/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"TenantArmorStack-AILeaseProcessingDLQ"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.197.0","metadata":[]}},"AILeaseProcessingQueue":{"id":"AILeaseProcessingQueue","path":"TenantArmorStack/AILeaseProcessingQueue","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/AILeaseProcessingQueue/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"queueName":"TenantArmorStack-AILeaseProcessingQueue","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["AILeaseProcessingDLQ7E231DA2","Arn"]},"maxReceiveCount":3},"visibilityTimeout":900}},"constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.197.0","metadata":[]}},"NextJsApiPolicy":{"id":"NextJsApiPolicy","path":"TenantArmorStack/NextJsApiPolicy","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/NextJsApiPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject","s3:PutObject"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["LeaseUploadsBucketDC35BC91","Arn"]},"/*"]]}},{"Action":"s3:GetObject","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["LeaseUploadsBucketDC35BC91","Arn"]},"/uploads/*"]]}},{"Action":["dynamodb:GetItem","dynamodb:PutItem","dynamodb:Query","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["EvictionTemplatesTable3873B700","Arn"]},{"Fn::GetAtt":["LeaseAnalysesTableB22F85EA","Arn"]}]},{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":{"Fn::GetAtt":["ProcessUploadedLeaseLambda6238D151","Arn"]}},{"Action":"sqs:SendMessage","Effect":"Allow","Resource":{"Fn::GetAtt":["AILeaseProcessingQueue3D3BAE1B","Arn"]}}],"Version":"2012-10-17"},"policyName":"NextJsApiPolicyAB2F22D0","users":[{"Ref":"PlaceholderNextJsUserFA5D6A0D"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.197.0","metadata":[]}},"PlaceholderNextJsUser":{"id":"PlaceholderNextJsUser","path":"TenantArmorStack/PlaceholderNextJsUser","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/PlaceholderNextJsUser/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::User","aws:cdk:cloudformation:props":{}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnUser","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.User","version":"2.197.0","metadata":[]}},"NextJsApiPolicyNameOutput":{"id":"NextJsApiPolicyNameOutput","path":"TenantArmorStack/NextJsApiPolicyNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"VercelIamRoleGuidance":{"id":"VercelIamRoleGuidance","path":"TenantArmorStack/VercelIamRoleGuidance","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"TenantArmorApi":{"id":"TenantArmorApi","path":"TenantArmorStack/TenantArmorApi","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/TenantArmorApi/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"API for TenantArmor services.","name":"TenantArmorStack-TenantArmorApi"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.197.0"}},"CloudWatchRole":{"id":"CloudWatchRole","path":"TenantArmorStack/TenantArmorApi/CloudWatchRole","children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"TenantArmorStack/TenantArmorApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"Resource":{"id":"Resource","path":"TenantArmorStack/TenantArmorApi/CloudWatchRole/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.197.0","metadata":[]}},"Account":{"id":"Account","path":"TenantArmorStack/TenantArmorApi/Account","attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["TenantArmorApiCloudWatchRoleE2A31DF7","Arn"]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.197.0"}},"Deployment":{"id":"Deployment","path":"TenantArmorStack/TenantArmorApi/Deployment","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/TenantArmorApi/Deployment/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"API for TenantArmor services.","restApiId":{"Ref":"TenantArmorApi6FD33BF1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.197.0","metadata":[]}},"DeploymentStage.v1":{"id":"DeploymentStage.v1","path":"TenantArmorStack/TenantArmorApi/DeploymentStage.v1","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/TenantArmorApi/DeploymentStage.v1/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"TenantArmorApiDeployment9D8549B3a4c04fe45fff730eeb76f6876524f36a"},"restApiId":{"Ref":"TenantArmorApi6FD33BF1"},"stageName":"v1"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.197.0","metadata":[]}},"Endpoint":{"id":"Endpoint","path":"TenantArmorStack/TenantArmorApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"Default":{"id":"Default","path":"TenantArmorStack/TenantArmorApi/Default","children":{"OPTIONS":{"id":"OPTIONS","path":"TenantArmorStack/TenantArmorApi/Default/OPTIONS","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/TenantArmorApi/Default/OPTIONS/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Fn::GetAtt":["TenantArmorApi6FD33BF1","RootResourceId"]},"restApiId":{"Ref":"TenantArmorApi6FD33BF1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.197.0","metadata":[]}},"AILeaseProcessingLambdaRole":{"id":"AILeaseProcessingLambdaRole","path":"TenantArmorStack/AILeaseProcessingLambdaRole","children":{"ImportAILeaseProcessingLambdaRole":{"id":"ImportAILeaseProcessingLambdaRole","path":"TenantArmorStack/AILeaseProcessingLambdaRole/ImportAILeaseProcessingLambdaRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"Resource":{"id":"Resource","path":"TenantArmorStack/AILeaseProcessingLambdaRole/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.197.0"}},"DefaultPolicy":{"id":"DefaultPolicy","path":"TenantArmorStack/AILeaseProcessingLambdaRole/DefaultPolicy","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/AILeaseProcessingLambdaRole/DefaultPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:GetItem","dynamodb:PutItem","dynamodb:UpdateItem"],"Effect":"Allow","Resource":{"Fn::GetAtt":["LeaseAnalysesTableB22F85EA","Arn"]}},{"Action":["sqs:ChangeMessageVisibility","sqs:DeleteMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl","sqs:ReceiveMessage"],"Effect":"Allow","Resource":{"Fn::GetAtt":["AILeaseProcessingQueue3D3BAE1B","Arn"]}},{"Action":"secretsmanager:GetSecretValue","Effect":"Allow","Resource":"arn:aws:secretsmanager:us-east-1:622703699030:secret:TenantArmorOpenAIKey-mruJz5"},{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AIPromptsTable3CCB588B","Arn"]},{"Ref":"AWS::NoValue"}]},{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AIPromptsBucket0DF82D69","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AIPromptsBucket0DF82D69","Arn"]},"/*"]]}]},{"Action":["ssm:GetParameter","ssm:GetParameters"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:ssm:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":parameter/tenant-armor/prompts/*"]]}}],"Version":"2012-10-17"},"policyName":"AILeaseProcessingLambdaRoleDefaultPolicyE5C90903","roles":[{"Ref":"AILeaseProcessingLambdaRoleE84880F0"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.197.0","metadata":[]}},"AILeaseProcessingLambda":{"id":"AILeaseProcessingLambda","path":"TenantArmorStack/AILeaseProcessingLambda","children":{"Code":{"id":"Code","path":"TenantArmorStack/AILeaseProcessingLambda/Code","children":{"Stage":{"id":"Stage","path":"TenantArmorStack/AILeaseProcessingLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.197.0"}},"AssetBucket":{"id":"AssetBucket","path":"TenantArmorStack/AILeaseProcessingLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.197.0"}},"Resource":{"id":"Resource","path":"TenantArmorStack/AILeaseProcessingLambda/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"dc4430861521e73f963e4d6344e751b5a658d7df42fe7845eb01da14db184265.zip"},"environment":{"variables":{"OPENAI_API_KEY_SECRET_NAME":"TenantArmorOpenAIKey","DYNAMODB_LEASE_ANALYSES_TABLE":{"Ref":"LeaseAnalysesTableB22F85EA"},"AI_PROCESSING_QUEUE_URL":{"Ref":"AILeaseProcessingQueue3D3BAE1B"},"OPENAI_MODEL":"gpt-4o","PROMPTS_TABLE_NAME":{"Ref":"AIPromptsTable3CCB588B"},"PROMPTS_BUCKET_NAME":{"Ref":"AIPromptsBucket0DF82D69"}}},"functionName":"TenantArmorStack-AILeaseProcessingLambda","handler":"index.handler","memorySize":1024,"role":{"Fn::GetAtt":["AILeaseProcessingLambdaRoleE84880F0","Arn"]},"runtime":"nodejs20.x","timeout":900}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.197.0","metadata":[]}},"AILeaseProcessingEventSourceMapping":{"id":"AILeaseProcessingEventSourceMapping","path":"TenantArmorStack/AILeaseProcessingEventSourceMapping","children":{"Resource":{"id":"Resource","path":"TenantArmorStack/AILeaseProcessingEventSourceMapping/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":1,"eventSourceArn":{"Fn::GetAtt":["AILeaseProcessingQueue3D3BAE1B","Arn"]},"functionName":{"Ref":"AILeaseProcessingLambdaC5ABBDB3"},"maximumBatchingWindowInSeconds":0}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.197.0","metadata":[]}},"LeaseUploadBucketNameOutput":{"id":"LeaseUploadBucketNameOutput","path":"TenantArmorStack/LeaseUploadBucketNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"LeaseAnalysesTableNameOutput":{"id":"LeaseAnalysesTableNameOutput","path":"TenantArmorStack/LeaseAnalysesTableNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"ProcessPdfFunctionNameOutput":{"id":"ProcessPdfFunctionNameOutput","path":"TenantArmorStack/ProcessPdfFunctionNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"ApiGatewayEndpointOutput":{"id":"ApiGatewayEndpointOutput","path":"TenantArmorStack/ApiGatewayEndpointOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"AILeaseProcessingQueueUrlOutput":{"id":"AILeaseProcessingQueueUrlOutput","path":"TenantArmorStack/AILeaseProcessingQueueUrlOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"AILeaseProcessingQueueArnOutput":{"id":"AILeaseProcessingQueueArnOutput","path":"TenantArmorStack/AILeaseProcessingQueueArnOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"AILeaseProcessingLambdaNameOutput":{"id":"AILeaseProcessingLambdaNameOutput","path":"TenantArmorStack/AILeaseProcessingLambdaNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"EvictionTemplatesTableNameOutput":{"id":"EvictionTemplatesTableNameOutput","path":"TenantArmorStack/EvictionTemplatesTableNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"PromptsTableNameOutput":{"id":"PromptsTableNameOutput","path":"TenantArmorStack/PromptsTableNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"PromptsBucketNameOutput":{"id":"PromptsBucketNameOutput","path":"TenantArmorStack/PromptsBucketNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"TenantArmorStack/CDKMetadata","children":{"Default":{"id":"Default","path":"TenantArmorStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}},"Condition":{"id":"Condition","path":"TenantArmorStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.197.0"}}},"constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"BootstrapVersion":{"id":"BootstrapVersion","path":"TenantArmorStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.197.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"TenantArmorStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.197.0"}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}},"constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.197.0"}}}